<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,minimal-ui">
    <title>Random Graph Evolution - Erdős-Rényi Model & Giant Component</title>
    <link rel="stylesheet" href="styles.css">
    <style>
      /* Modal styles */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.8);
      }
      
      .modal-content {
        background-color: #14151f;
        margin: 5% auto;
        padding: 20px;
        border: 1px solid #333;
        border-radius: 8px;
        width: 80%;
        max-width: 800px;
        max-height: 80vh;
        overflow-y: auto;
        color: #fff;
      }
      
      .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
      }
      
      .close:hover,
      .close:focus {
        color: #fff;
        text-decoration: none;
        cursor: pointer;
      }
      
      .modal h2 {
        color: #76f09b;
        border-bottom: 1px solid #333;
        padding-bottom: 10px;
      }
      
      .modal h3 {
        color: #f5b862;
        margin-top: 20px;
      }
      
      .key-concept {
        background-color: rgba(255, 255, 255, 0.1);
        padding: 15px;
        margin: 15px 0;
        border-radius: 5px;
        border-left: 4px solid #0077ff;
      }
    </style>
  </head>
  <body>
    <div class="matter-demo">
      <div class="matter-header-outer">
        <header class="matter-header">
          <div class="matter-header-inner">
            <h1 class="matter-demo-title">
              <a href="#">Random Graph Evolution</a>
            </h1>
            <div class="matter-toolbar">
              <button class="matter-btn matter-btn-reset" title="Reset" id="reset-btn">
                <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                  <path d="M0 0h24v24H0z" fill="none"/>
                </svg>
              </button>
              <button class="matter-btn matter-btn-inspect" title="Inspect" id="inspect-btn">
                <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M0 0h24v24H0z" fill="none"/>
                  <path d="M11 4.07V2.05c-2.01.2-3.84 1-5.32 2.21L7.1 5.69c1.11-.86 2.44-1.44 3.9-1.62zm7.32.19C16.84 3.05 15.01 2.25 13 2.05v2.02c1.46.18 2.79.76 3.9 1.62l1.42-1.43zM19.93 11h2.02c-.2-2.01-1-3.84-2.21-5.32L18.31 7.1c.86 1.11 1.44 2.44 1.62 3.9zM5.69 7.1L4.26 5.68C3.05 7.16 2.25 8.99 2.05 11h2.02c.18-1.46.76-2.79 1.62-3.9zM4.07 13H2.05c.2 2.01 1 3.84 2.21 5.32l1.43-1.43c-.86-1.1-1.44-2.43-1.62-3.89zM15 12c0-1.66-1.34-3-3-3s-3 1.34-3 3 1.34 3 3 3 3-1.34 3-3zm3.31 4.9l1.43 1.43c1.21-1.48 2.01-3.32 2.21-5.32h-2.02c-.18 1.45-.76 2.78-1.62 3.89zM13 19.93v2.02c2.01-.2 3.84-1 5.32-2.21l-1.43-1.43c-1.1.86-2.43 1.44-3.89 1.62zm-7.32-.19C7.16 20.95 9 21.75 11 21.95v-2.02c-1.46-.18-2.79-.76-3.9-1.62l-1.42 1.43z"/>
                </svg>
              </button>
              <button class="matter-btn matter-btn-fullscreen" title="Fullscreen" id="fullscreen-btn">
                <svg fill="#000000" height="22" viewBox="0 0 22 22" width="22" xmlns="http://www.w3.org/2000/svg">
                  <path d="M0 0h24v24H0z" fill="none"/>
                  <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
                </svg>
              </button>
              <button class="matter-btn matter-btn-info" title="Info" id="info-btn">
                <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
                  <path d="M0 0h24v24H0z" fill="none"/>
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
                </svg>
              </button>
            </div>
            <a class="matter-link" href="https://brm.io/matter-js/" title="matter.js" target="_blank">
              <svg class="matter-logo" height="100" viewBox="0 952.04859 330 100" width="268" xmlns="http://www.w3.org/2000/svg">
                <path id="m-triangle" style="fill:#76f09b;" d="m 115.83215,1052.3622 -57.916072,0 -57.916078053812107,0 L 28.958038,1002.2054 57.916077,952.04859 86.874114,1002.2054 Z" />
                <path id="m-square" style="fill:#f55f5f" d="m 168.03172,952.36218 0,100.00002 100,0 0,-100.00002 -100,0 z" />
                <circle id="m-circle" style="fill:#f5b862" r="12.947398" cy="1039.4148" cx="140.28374" />
              </svg>
            </a>
          </div>
        </header>
      </div>
      
      <!-- Canvas will be inserted here by Matter.js -->
      
      <!-- Action buttons -->
      <div class="action-buttons">
        <button id="add-connection-btn" class="action-button">Add Manual Connection</button>
      </div>
      
      <!-- Inspector panel (hidden by default) -->
      <div class="ins-container">
        <div class="ins-top-panel">
          <input type="search" class="ins-search-box" placeholder="Search objects..." />
        </div>
        <div class="ins-control-group">
          <button class="ins-button">Select</button>
          <button class="ins-button">Pan</button>
        </div>
        <div class="ins-world-tree">
          <!-- Tree view will be populated dynamically -->
        </div>
      </div>
      
      <!-- Legend panel -->
      <div id="legend-panel">
        <h3>Legend</h3>
        <div class="legend-item">
          <div class="legend-color" style="background-color: #0077ff;"></div>
          <div>Isolated Nodes</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background-color: #ff5500;"></div>
          <div>Giant Component</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background-color: #76f09b;"></div>
          <div>Small Components</div>
        </div>
      </div>
      
      <!-- Information Modal -->
      <div id="info-modal" class="modal">
        <div class="modal-content">
          <span class="close">&times;</span>
          <h2>Random Graph Evolution</h2>
          
          <p>This simulation demonstrates key concepts from random graph theory as developed by Erdős-Rényi and the phenomenon of the "birth of the giant component" described by Donald Knuth.</p>
          
          <h3>Erdős-Rényi Random Graph Model</h3>
          <p>In this model, edges are added to a graph with probability p. The simulation shows how the graph structure evolves as more edges are added.</p>
          
          <div class="key-concept">
            <p><strong>Phase Transition at p = 1/n:</strong> When the edge probability reaches this critical threshold, a "giant component" emerges - a connected component containing a significant portion of all nodes.</p>
          </div>
          
          <h3>Birth of the Giant Component</h3>
          <p>As you add edges to the graph:</p>
          <ul>
            <li>Initially, the graph consists of many small components (clusters of connected nodes).</li>
            <li>As more edges are added, these components start to merge.</li>
            <li>At the critical threshold p = 1/n, there's a phase transition where suddenly many components merge to form a giant component.</li>
            <li>After this threshold, the giant component grows rapidly, absorbing more of the smaller components.</li>
          </ul>
          
          <h3>How to Use This Simulation</h3>
          <ul>
            <li>Use the slider to adjust the edge probability p.</li>
            <li>Click "Step" to add new edges based on the current probability.</li>
            <li>Click "Auto" to automatically add edges at regular intervals.</li>
            <li>Watch for the formation of the giant component when p approaches 1/n.</li>
            <li>Components are color-coded to help visualize distinct connected parts of the graph.</li>
          </ul>
          
          <p>This simulation helps visualize the surprising phenomenon that adding just a few critical edges can dramatically change the structure of a random graph.</p>
        </div>
      </div>
    </div>
    
    <script type="module" src="./index.ts"></script>
    <script>
      // Modal functionality
      document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('info-modal');
        const infoBtn = document.getElementById('info-btn');
        const closeBtn = document.querySelector('.close');
        
        // Open modal when info button is clicked
        infoBtn.addEventListener('click', function() {
          modal.style.display = 'block';
        });
        
        // Close modal when close button is clicked
        closeBtn.addEventListener('click', function() {
          modal.style.display = 'none';
        });
        
        // Close modal when clicking outside the modal content
        window.addEventListener('click', function(event) {
          if (event.target === modal) {
            modal.style.display = 'none';
          }
        });
      });
    </script>
  </body>
</html>